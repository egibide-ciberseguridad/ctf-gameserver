{% extends 'base.html' %}
{% load i18n %}
{% load static %}

{% block content %}
<div>
    <h1>{% block title %}{% trans 'VPN Status History' %}{% endblock %}</h1>
</div>

{% if allow_team_selection %}
<div class="clearfix mb-4">
    <form method="GET" class="d-flex flex-row justify-content-end align-items-center">
        <label for="net-number" class="me-3">{% trans 'Team Net Number' %}:</label>
        <input type="number" name="net-number" id="net-number" class="number-field form-control me-3" min="1" value="{{ net_number | default_if_none:'' }}" />
        <button type="submit" class="btn btn-secondary">{% trans 'Select' %}</button>
    </form>
</div>
{% endif %}

{% if check_results is not None %}
<div class="table-responsive">
    <table class="table">
        <thead>
            <tr>
                <th scope="col">{% trans 'Time' %} ({{ server_timezone }})</th>
                <th scope="col">{% trans 'Last WireGuard Handshake' %}</th>
                <th scope="col">{% trans 'Gateway Ping RTT' %}</th>
                <th scope="col">{% trans 'Testing Vulnbox Ping RTT' %}</th>
                <th scope="col">{% trans 'Testing Vulnbox Service' %}</th>
                <th scope="col">{% trans 'Vulnbox Ping RTT' %}</th>
                <th scope="col">{% trans 'Vulnbox Service' %}</th>
            </tr>
        </thead>

        <tbody>
        {% for result in check_results %}
            <tr>
                <td>
                    {{ result.timestamp | date }} {{ result.timestamp | time }}
                </td>
                <td class="{% if result.wireguard_ok %}success{% else %}danger{% endif %}">
                    {% if result.wireguard_handshake_time is not None %}
                    {{ result.wireguard_handshake_time | time }}
                    {% else %}
                    <abbr title="{% trans 'Not available' %}">{% trans 'N/A' %}</abbr>
                    {% endif %}
                </td>
                {% if result.gateway_ping_rtt_ms is not None %}
                <td class="text-success">
                    {{ result.gateway_ping_rtt_ms }}&nbsp;ms
                </td>
                {% else %}
                <td class="text-danger">
                    {% trans 'down' %}
                </td>
                {% endif %}
                {% if result.demo_ping_rtt_ms is not None %}
                <td class="text-success">
                    {{ result.demo_ping_rtt_ms }}&nbsp;ms
                </td>
                {% else %}
                <td class="text-danger">
                    {% trans 'down' %}
                </td>
                {% endif %}
                {% if result.demo_service_ok %}
                <td class="text-success">
                    {% trans 'up' %}
                </td>
                {% else %}
                <td class="text-danger">
                    {% trans 'down' %}
                </td>
                {% endif %}
                {% if result.vulnbox_ping_rtt_ms is not None %}
                <td class="text-success">
                    {{ result.vulnbox_ping_rtt_ms }}&nbsp;ms
                </td>
                {% else %}
                <td class="text-danger">
                    {% trans 'down' %}
                </td>
                {% endif %}
                {% if result.vulnbox_service_ok %}
                <td class="text-success">
                    {% trans 'up' %}
                </td>
                {% else %}
                <td class="text-danger">
                    {% trans 'down' %}
                </td>
                {% endif %}
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}
{% endblock %}
